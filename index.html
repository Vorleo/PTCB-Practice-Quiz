
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>PTCE Practice Tool</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#000;
  color:#00ff9c;
}

#boot{
  position:fixed;
  inset:0;
  background:black;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
}

#boot pre{
  font-size:14px;
  text-align:center;
  color:#00ff9c;
}

#app{
  display:none;
  padding:20px;
}

button{
  padding:10px 16px;
  margin:8px;
  background:#002b1a;
  color:#00ff9c;
  border:1px solid #00ff9c;
  cursor:pointer;
}

.card{
  border:1px solid #00ff9c;
  padding:16px;
  margin:16px 0;
}
</style>
</head>

<body>

<div id="boot">
<pre id="bootLogo"></pre>
<button onclick="skipBoot()">ENTER</button>
</div>

<div id="app">
<h1>PTCE PRACTICE TOOL</h1>
<button onclick="startTest()">Practice Test</button>
<button onclick="startFlash()">Flashcards</button>

<div id="content"></div>
</div>

<script>

const logo = `
██████╗ ████████╗ ██████╗ ███████╗
██╔══██╗╚══██╔══╝██╔════╝ ██╔════╝
██████╔╝   ██║   ██║      █████╗
██╔═══╝    ██║   ██║      ██╔══╝
██║        ██║   ╚██████╗ ███████╗
╚═╝        ╚═╝    ╚═════╝ ╚══════╝

PTCE PRACTICE TOOL
A Vault Tec program by Joshua Vorhies
`;

document.getElementById("bootLogo").textContent = logo;

function skipBoot(){
  document.getElementById("boot").style.display="none";
  document.getElementById("app").style.display="block";
}

// ---------- SAFE RELATIVE FETCH ----------

async function safeFetch(name){
  const path = "./" + name;
  const res = await fetch(path);
  if(!res.ok) throw new Error(name+" failed to load");
  return res.json();
}

// ---------- LOAD BANKS ----------

let BANKS = null;

async function loadBanks(){
  if(BANKS) return BANKS;

  const [med,safety,order,federal] = await Promise.all([
    safeFetch("med_bank.json"),
    safeFetch("safety_bank.json"),
    safeFetch("order_bank.json"),
    safeFetch("federal_bank.json")
  ]);

  BANKS = {med,safety,order,federal};
  return BANKS;
}

// ---------- TEST ----------

function shuffle(a){
  return a.sort(()=>Math.random()-0.5);
}

async function startTest(){
  const banks = await loadBanks();

  let pool = [
    ...banks.med,
    ...banks.safety,
    ...banks.order,
    ...banks.federal
  ];

  pool = shuffle(pool).slice(0,90);

  let html = "<h2>Test (90 Questions)</h2>";

  pool.forEach((q,i)=>{
    const choices = shuffle([q.correct, ...(q.wrong||[]).slice(0,3)]);
    html+=`
      <div class="card">
        <b>Q${i+1}. ${q.question}</b><br>
        ${choices.map(c=>`<div>${c}</div>`).join("")}
      </div>
    `;
  });

  document.getElementById("content").innerHTML = html;
}

// ---------- FLASH ----------

async function startFlash(){
  const banks = await loadBanks();

  let html = "<h2>Flashcards</h2>";

  banks.med.slice(0,20).forEach(c=>{
    html+=`
      <div class="card">
        <b>${c.question}</b><br>
        ${c.correct}
      </div>
    `;
  });

  document.getElementById("content").innerHTML = html;
}

</script>
</body>
</html>
