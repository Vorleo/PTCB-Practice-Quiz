
<!DOCTYPE html>
<html lang="en" data-theme="fallout">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PTCB Practice System</title>

<style>
body{
 margin:0;
 font-family: ui-monospace, monospace;
 background:#020403;
 color:#7cff9e;
}

/* THEMES */
[data-theme="vegas"] body{
 color:#ffb347;
 background:#0b0703;
}

/* BOOT */
#boot{
 position:fixed;
 inset:0;
 background:black;
 display:flex;
 flex-direction:column;
 justify-content:center;
 align-items:center;
 z-index:9999;
}
.scan{
 position:absolute;
 inset:0;
 background:repeating-linear-gradient(rgba(0,0,0,.3) 0px, rgba(0,0,0,.3) 2px, transparent 2px, transparent 6px);
}
.crt{
 width:min(900px,92vw);
 height:320px;
 border:1px solid currentColor;
 padding:14px;
 background:rgba(0,0,0,.7);
 overflow:auto;
 white-space:pre-wrap;
 text-shadow:0 0 8px currentColor;
}
.barwrap{
 width:min(900px,92vw);
 border:1px solid currentColor;
 margin-top:10px;
 height:10px;
}
.bar{ height:100%; width:0%; background:currentColor; transition:.3s; }

/* APP */
#app{ display:none; padding:12px; }
.panel{ border:1px solid currentColor; padding:10px; margin-bottom:10px; }
.choice{ border:1px solid currentColor; padding:8px; margin-bottom:6px; cursor:pointer; }
button{ background:currentColor; color:black; border:none; padding:8px 12px; margin:4px; font-weight:bold; cursor:pointer; }

/* TERMINAL SCROLL BG */
#terminalBG{
 position:fixed;
 inset:0;
 opacity:.06;
 pointer-events:none;
 white-space:pre;
 font-size:11px;
 line-height:13px;
}
</style>
</head>

<body>

<div id="terminalBG"></div>

<div id="boot">
<div class="scan"></div>
<div class="crt" id="bootText"></div>
<div class="barwrap"><div class="bar" id="bootBar"></div></div>
</div>

<div id="app">

<div class="panel">
<h2>PTCB Practice System</h2>
<button onclick="setTheme('fallout')">Fallout</button>
<button onclick="setTheme('vegas')">New Vegas</button>
<button onclick="startTest()">Start Test</button>
<button onclick="startFlash()">Flashcards</button>
</div>

<div class="panel" id="questionPanel"></div>

</div>

<script>

/* TERMINAL SCROLL */
(function(){
 let el=document.getElementById("terminalBG");
 let text="";
 for(let i=0;i<400;i++){
  text+="VAULT-TEC LOG "+Math.random().toString(16).slice(2)+"\n";
 }
 el.textContent=text;
})();

/* THEME */
function setTheme(t){
 document.documentElement.setAttribute("data-theme",t);
}

/* JSON LOAD */
let BANKS={};
async function loadBanks(){
 BANKS.med=await fetch("med_bank.json").then(r=>r.json());
 BANKS.safe=await fetch("safety_bank.json").then(r=>r.json());
 BANKS.order=await fetch("order_bank.json").then(r=>r.json());
 BANKS.fed=await fetch("federal_bank.json").then(r=>r.json());
}
loadBanks();

/* TEST ENGINE */
let test=[];
let idx=0;
let answers={};
let flags={};
let tips=5;

function pick(arr,n){
 let o=[];
 while(o.length<n){
  o.push(arr[Math.floor(Math.random()*arr.length)]);
 }
 return o;
}

function buildTest(){
 test=[
 ...pick(BANKS.med,32),
 ...pick(BANKS.safe,21),
 ...pick(BANKS.order,20),
 ...pick(BANKS.fed,17)
 ];
}

function startTest(){
 buildTest();
 idx=0;
 renderQ();
}

function renderQ(){
 let q=test[idx];
 let opts=[q.correct,...q.wrong].sort(()=>Math.random()-.5);

 document.getElementById("questionPanel").innerHTML=
 `<h3>Q ${idx+1}/90</h3>
 <div>${q.question}</div>
 <div>Tips Left: ${tips}</div>
 `+
 opts.map(o=>`<div class="choice" onclick="answers[${idx}]='${o}'">${o}</div>`).join("")+
 `<button onclick="prev()">Prev</button>
 <button onclick="next()">Next</button>
 <button onclick="flag()">Flag</button>
 <button onclick="useTip()">Tip</button>
 <button onclick="submitTest()">Submit</button>`;
}

function next(){ if(idx<89){ idx++; renderQ(); }}
function prev(){ if(idx>0){ idx--; renderQ(); }}
function flag(){ flags[idx]=!flags[idx]; renderQ(); }
function useTip(){ if(tips>0){ tips--; renderQ(); }}

function submitTest(){
 let c=0;
 test.forEach((q,i)=>{ if(answers[i]===q.correct) c++; });
 alert("Score "+c+"/90");
}

/* FLASHCARDS */
let flash=[];
let fIdx=0;

function startFlash(){
 flash=BANKS.med.slice(0,200);
 fIdx=0;
 showFlash();
}

function showFlash(){
 let f=flash[fIdx];
 document.getElementById("questionPanel").innerHTML=
 `<h3>Flash ${fIdx+1}</h3>
 <div>${f.question}</div>
 <div><b>${f.correct}</b></div>
 <button onclick="nextFlash()">Next</button>`;
}
function nextFlash(){ fIdx=(fIdx+1)%flash.length; showFlash(); }

/* BOOT */
(function(){
 const lines=[
 "VAULT TEC BIOS",
 "CHECKING MEMORY",
 "LOADING MED DATABASE",
 "LOADING SAFETY PROTOCOLS",
 "LOADING DEA / USP",
 "INIT TERMINAL",
 "READY"
 ];
 let i=0;
 function hex(){ return "0x"+Math.random().toString(16).slice(2,10); }
 function step(){
  let t=document.getElementById("bootText");
  let b=document.getElementById("bootBar");
  if(i<lines.length){
   t.textContent+=lines[i]+" "+hex()+"\n";
   b.style.width=((i+1)/lines.length*100)+"%";
   i++;
   setTimeout(step,350+Math.random()*200);
  }else{
   document.getElementById("boot").remove();
   document.getElementById("app").style.display="block";
  }
 }
 document.addEventListener("DOMContentLoaded",()=>setTimeout(step,200));
})();

</script>

</body>
</html>
